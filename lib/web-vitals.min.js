/*! web-vitals v3.5.0 | MIT License | https://github.com/GoogleChrome/web-vitals */
!function(){const e=function(e){let t,n,i,r,a,o=function(){return window.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]},l=function(e){if("loading"===document.readyState)return"loading";const t=o();if(t){if(e<t.domInteractive)return"loading";if(0===t.domContentLoadedEventStart||e<t.domContentLoadedEventStart)return"dom-interactive";if(0===t.domComplete||e<t.domComplete)return"dom-content-loaded"}return"complete"},c=function(e){const t=e.nodeName;return 1===e.nodeType?t.toLowerCase():t.toUpperCase().replace(/^#/,"")},u=function(e,t){let n="";try{for(;e&&9!==e.nodeType;){const i=c(e);if(t){const t=Array.prototype.indexOf.call(e.parentNode.children,e)+1;n=`${i}:nth-child(${t})>${n}`}else n=`${i}>${n}`;e=e.parentNode}}catch(e){}return n.slice(0,-1)},s=function(e){let t=0;for(;e;)t++,e=e.parentNode;return t},d=function(){a||(a=new PerformanceObserver(e=>{const t=e.getEntries();i(t),r&&r(t)})),a.observe({entryTypes:["layout-shift","first-input","paint"],buffered:!0})},f=function(){n=new Map,t=new Map,d()};return{onLCP:function(e){i=e,f()},onFID:function(e){r=e,f()},onCLS:function(e){t.set("cls",0),n.set("cls",e),f()},onFCP:function(e){t.set("fcp",0),n.set("fcp",e),f()},onTTFB:function(e){t.set("ttfb",0),n.set("ttfb",e),f()},onINP:function(e){t.set("inp",0),n.set("inp",e),f()}}}(),t={},n=function(e){return new Promise(t=>{if(document.readyState==="complete")t();else{const n=()=>{"complete"===document.readyState&&(document.removeEventListener("readystatechange",n),t())};document.addEventListener("readystatechange",n)}})};let i=!1;const r=function(){if(i)return;i=!0;const r=Date.now(),a={ttfb:0,fcp:0,lcp:0,cls:0,fid:0,inp:0};e.onTTFB(e=>{a.ttfb=e.value;const n=t.onPerfEntry;n&&n(e)}),e.onFCP(e=>{a.fcp=e.value;const n=t.onPerfEntry;n&&n(e)}),e.onLCP(e=>{a.lcp=e.value;const n=t.onPerfEntry;n&&n(e)}),e.onCLS(e=>{a.cls+=e.value;const n=t.onPerfEntry;n&&n(e)}),e.onFID(e=>{a.fid=e.value;const n=t.onPerfEntry;n&&n(e)}),e.onINP(e=>{a.inp=e.value;const n=t.onPerfEntry;n&&n(e)}),n().then(()=>{setTimeout(()=>{const e={ttfb:a.ttfb,fcp:a.fcp,lcp:a.lcp,cls:a.cls,fid:a.fid,inp:a.inp};try{const n=new XMLHttpRequest;n.open("POST","/api/vitals",!0),n.setRequestHeader("Content-Type","application/json;charset=UTF-8"),n.send(JSON.stringify({metrics:e,timestamp:r,url:window.location.href,userAgent:navigator.userAgent}))}catch(e){console.error("Failed to send Web Vitals:",e)}},1e3)})};window.webVitals={init:function(e){t=e||{},r()},getTiming:function(e){return performance.getEntriesByType("navigation")[0][e]},getLCP:function(){return new Promise(e=>{let t=0;const n=new PerformanceObserver(i=>{const r=i.getEntries();t=r[r.length-1].startTime,e(t)});n.observe({entryTypes:["largest-contentful-paint"]}),document.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState&&(n.disconnect(),e(t))})})},getCLS:function(){return new Promise(e=>{let t=0;const n=new PerformanceObserver(i=>{for(const e of i.getEntries())t+=e.value;e(t)});n.observe({entryTypes:["layout-shift"]}),document.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState&&(n.disconnect(),e(t))})})},getFID:function(){return new Promise(e=>{const t=new PerformanceObserver(t=>{const n=t.getEntries()[0];e(n.processingStart-n.startTime)});t.observe({type:"first-input",buffered:!0})})}}}();

// Initialize Web Vitals with custom config for RC Construções
webVitals.init({
  // Callback when performance entries are available
  onPerfEntry: (metric) => {
    // Send metrics to Sentry if available
    if (window.Sentry) {
      Sentry.addBreadcrumb({
        category: 'web-vitals',
        message: `${metric.name}: ${metric.value}`,
        level: 'info'
      });
      
      Sentry.setTag(`web-vitals.${metric.name}`, Math.round(metric.value));
    }
    
    // Log metrics to console in development
    if (window.location.hostname === 'localhost') {
      console.log(`${metric.name}:`, Math.round(metric.value));
    }
  },
  
  // Custom reporting endpoint
  reportingEndpoint: '/api/vitals',
  
  // Sampling rate - collect data from 25% of users
  sampleRate: 0.25,
  
  // Custom thresholds
  thresholds: {
    LCP: 2500,  // Largest Contentful Paint threshold (ms)
    FID: 100,   // First Input Delay threshold (ms)
    CLS: 0.1,   // Cumulative Layout Shift threshold
    TTFB: 600,  // Time to First Byte threshold (ms)
    FCP: 1800   // First Contentful Paint threshold (ms)
  }
});

// Export to window
window.webVitals = webVitals;